// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`calculating env build with (dep with (dep with local export) with local export) 1`] = `
Object {
  "env": Map {
    "OCAMLPATH" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLPATH",
      "value": "<storePath>/i/dep-of-dep/lib:<storePath>/i/dep/lib",
    },
    "OCAMLFIND_DESTDIR" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_DESTDIR",
      "value": "<storePath>/s/app/lib",
    },
    "OCAMLFIND_LDCONF" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_LDCONF",
      "value": "ignore",
    },
    "OCAMLFIND_COMMANDS" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_COMMANDS",
      "value": "ocamlc=ocamlc.opt ocamldep=ocamldep.opt ocamldoc=ocamldoc.opt ocamllex=ocamllex.opt ocamlopt=ocamlopt.opt",
    },
    "PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "PATH",
      "value": "<storePath>/i/dep-of-dep/bin:<storePath>/i/dep/bin:$PATH",
    },
    "MAN_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "MAN_PATH",
      "value": "<storePath>/i/dep-of-dep/man:<storePath>/i/dep/man:$MAN_PATH",
    },
    "cur__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "cur__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "cur__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "cur__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__depends",
      "spec": BuildSpec { id: "app" },
      "value": "dep",
    },
    "cur__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "cur__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app",
    },
    "cur__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/bin",
    },
    "cur__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/sbin",
    },
    "cur__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/lib",
    },
    "cur__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/man",
    },
    "cur__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/doc",
    },
    "cur__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/stublibs",
    },
    "cur__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/toplevel",
    },
    "cur__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/share",
    },
    "cur__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/etc",
    },
    "dep__var" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "dep__var",
      "spec": BuildSpec { id: "dep" },
      "value": "hello",
    },
  },
  "scope": Map {
    "dep__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__name",
      "spec": BuildSpec { id: "dep" },
      "value": "dep",
    },
    "dep__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__version",
      "spec": BuildSpec { id: "dep" },
      "value": "0.1.0",
    },
    "dep__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__root",
      "spec": BuildSpec { id: "dep" },
      "value": "<sandboxPath>/dep",
    },
    "dep__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__depends",
      "spec": BuildSpec { id: "dep" },
      "value": "dep-of-dep",
    },
    "dep__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__target_dir",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/b/dep",
    },
    "dep__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__install",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep",
    },
    "dep__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__bin",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/bin",
    },
    "dep__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__sbin",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/sbin",
    },
    "dep__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__lib",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/lib",
    },
    "dep__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__man",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/man",
    },
    "dep__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__doc",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/doc",
    },
    "dep__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__stublibs",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/stublibs",
    },
    "dep__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__toplevel",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/toplevel",
    },
    "dep__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__share",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/share",
    },
    "dep__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__etc",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/etc",
    },
    "dep__var" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "dep__var",
      "spec": BuildSpec { id: "dep" },
      "value": "hello",
    },
    "app__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "app__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "app__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "app__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__depends",
      "spec": BuildSpec { id: "app" },
      "value": "dep",
    },
    "app__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "app__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app",
    },
    "app__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/bin",
    },
    "app__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/sbin",
    },
    "app__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/lib",
    },
    "app__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/man",
    },
    "app__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/doc",
    },
    "app__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/stublibs",
    },
    "app__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/toplevel",
    },
    "app__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/share",
    },
    "app__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/etc",
    },
    "OCAMLPATH" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLPATH",
      "value": "<storePath>/i/dep-of-dep/lib:<storePath>/i/dep/lib",
    },
    "OCAMLFIND_DESTDIR" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_DESTDIR",
      "value": "<storePath>/s/app/lib",
    },
    "OCAMLFIND_LDCONF" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_LDCONF",
      "value": "ignore",
    },
    "OCAMLFIND_COMMANDS" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_COMMANDS",
      "value": "ocamlc=ocamlc.opt ocamldep=ocamldep.opt ocamldoc=ocamldoc.opt ocamllex=ocamllex.opt ocamlopt=ocamlopt.opt",
    },
    "PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "PATH",
      "value": "<storePath>/i/dep-of-dep/bin:<storePath>/i/dep/bin:$PATH",
    },
    "MAN_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "MAN_PATH",
      "value": "<storePath>/i/dep-of-dep/man:<storePath>/i/dep/man:$MAN_PATH",
    },
    "cur__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "cur__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "cur__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "cur__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__depends",
      "spec": BuildSpec { id: "app" },
      "value": "dep",
    },
    "cur__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "cur__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app",
    },
    "cur__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/bin",
    },
    "cur__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/sbin",
    },
    "cur__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/lib",
    },
    "cur__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/man",
    },
    "cur__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/doc",
    },
    "cur__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/stublibs",
    },
    "cur__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/toplevel",
    },
    "cur__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/share",
    },
    "cur__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/etc",
    },
  },
}
`;

exports[`calculating env build with (dep with local export) 1`] = `
Object {
  "env": Map {
    "OCAMLPATH" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLPATH",
      "value": "<storePath>/i/dep/lib",
    },
    "OCAMLFIND_DESTDIR" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_DESTDIR",
      "value": "<storePath>/s/app/lib",
    },
    "OCAMLFIND_LDCONF" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_LDCONF",
      "value": "ignore",
    },
    "OCAMLFIND_COMMANDS" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_COMMANDS",
      "value": "ocamlc=ocamlc.opt ocamldep=ocamldep.opt ocamldoc=ocamldoc.opt ocamllex=ocamllex.opt ocamlopt=ocamlopt.opt",
    },
    "PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "PATH",
      "value": "<storePath>/i/dep/bin:$PATH",
    },
    "MAN_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "MAN_PATH",
      "value": "<storePath>/i/dep/man:$MAN_PATH",
    },
    "cur__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "cur__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "cur__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "cur__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__depends",
      "spec": BuildSpec { id: "app" },
      "value": "dep",
    },
    "cur__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "cur__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app",
    },
    "cur__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/bin",
    },
    "cur__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/sbin",
    },
    "cur__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/lib",
    },
    "cur__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/man",
    },
    "cur__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/doc",
    },
    "cur__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/stublibs",
    },
    "cur__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/toplevel",
    },
    "cur__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/share",
    },
    "cur__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/etc",
    },
    "dep__var" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "dep__var",
      "spec": BuildSpec { id: "dep" },
      "value": "hello",
    },
  },
  "scope": Map {
    "dep__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__name",
      "spec": BuildSpec { id: "dep" },
      "value": "dep",
    },
    "dep__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__version",
      "spec": BuildSpec { id: "dep" },
      "value": "0.1.0",
    },
    "dep__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__root",
      "spec": BuildSpec { id: "dep" },
      "value": "<sandboxPath>/dep",
    },
    "dep__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__depends",
      "spec": BuildSpec { id: "dep" },
      "value": "",
    },
    "dep__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__target_dir",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/b/dep",
    },
    "dep__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__install",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep",
    },
    "dep__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__bin",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/bin",
    },
    "dep__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__sbin",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/sbin",
    },
    "dep__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__lib",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/lib",
    },
    "dep__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__man",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/man",
    },
    "dep__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__doc",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/doc",
    },
    "dep__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__stublibs",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/stublibs",
    },
    "dep__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__toplevel",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/toplevel",
    },
    "dep__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__share",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/share",
    },
    "dep__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__etc",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/etc",
    },
    "dep__var" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "dep__var",
      "spec": BuildSpec { id: "dep" },
      "value": "hello",
    },
    "app__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "app__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "app__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "app__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__depends",
      "spec": BuildSpec { id: "app" },
      "value": "dep",
    },
    "app__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "app__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app",
    },
    "app__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/bin",
    },
    "app__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/sbin",
    },
    "app__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/lib",
    },
    "app__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/man",
    },
    "app__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/doc",
    },
    "app__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/stublibs",
    },
    "app__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/toplevel",
    },
    "app__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/share",
    },
    "app__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/etc",
    },
    "OCAMLPATH" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLPATH",
      "value": "<storePath>/i/dep/lib",
    },
    "OCAMLFIND_DESTDIR" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_DESTDIR",
      "value": "<storePath>/s/app/lib",
    },
    "OCAMLFIND_LDCONF" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_LDCONF",
      "value": "ignore",
    },
    "OCAMLFIND_COMMANDS" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_COMMANDS",
      "value": "ocamlc=ocamlc.opt ocamldep=ocamldep.opt ocamldoc=ocamldoc.opt ocamllex=ocamllex.opt ocamlopt=ocamlopt.opt",
    },
    "PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "PATH",
      "value": "<storePath>/i/dep/bin:$PATH",
    },
    "MAN_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "MAN_PATH",
      "value": "<storePath>/i/dep/man:$MAN_PATH",
    },
    "cur__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "cur__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "cur__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "cur__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__depends",
      "spec": BuildSpec { id: "app" },
      "value": "dep",
    },
    "cur__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "cur__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app",
    },
    "cur__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/bin",
    },
    "cur__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/sbin",
    },
    "cur__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/lib",
    },
    "cur__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/man",
    },
    "cur__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/doc",
    },
    "cur__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/stublibs",
    },
    "cur__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/toplevel",
    },
    "cur__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/share",
    },
    "cur__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/etc",
    },
  },
}
`;

exports[`calculating env build with (dep with local export) with global export referencing dep built-in 1`] = `
Object {
  "env": Map {
    "OCAMLPATH" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLPATH",
      "value": "<storePath>/i/dep/lib",
    },
    "OCAMLFIND_DESTDIR" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_DESTDIR",
      "value": "<storePath>/s/app/lib",
    },
    "OCAMLFIND_LDCONF" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_LDCONF",
      "value": "ignore",
    },
    "OCAMLFIND_COMMANDS" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_COMMANDS",
      "value": "ocamlc=ocamlc.opt ocamldep=ocamldep.opt ocamldoc=ocamldoc.opt ocamllex=ocamllex.opt ocamlopt=ocamlopt.opt",
    },
    "PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "PATH",
      "value": "<storePath>/i/dep/bin:$PATH",
    },
    "MAN_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "MAN_PATH",
      "value": "<storePath>/i/dep/man:$MAN_PATH",
    },
    "cur__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "cur__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "cur__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "cur__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__depends",
      "spec": BuildSpec { id: "app" },
      "value": "dep",
    },
    "cur__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "cur__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app",
    },
    "cur__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/bin",
    },
    "cur__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/sbin",
    },
    "cur__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/lib",
    },
    "cur__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/man",
    },
    "cur__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/doc",
    },
    "cur__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/stublibs",
    },
    "cur__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/toplevel",
    },
    "cur__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/share",
    },
    "cur__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/etc",
    },
    "APP" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "APP",
      "spec": BuildSpec { id: "app" },
      "value": "hello, dep",
    },
  },
  "scope": Map {
    "dep__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__name",
      "spec": BuildSpec { id: "dep" },
      "value": "dep",
    },
    "dep__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__version",
      "spec": BuildSpec { id: "dep" },
      "value": "0.1.0",
    },
    "dep__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__root",
      "spec": BuildSpec { id: "dep" },
      "value": "<sandboxPath>/dep",
    },
    "dep__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__depends",
      "spec": BuildSpec { id: "dep" },
      "value": "",
    },
    "dep__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__target_dir",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/b/dep",
    },
    "dep__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__install",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep",
    },
    "dep__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__bin",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/bin",
    },
    "dep__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__sbin",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/sbin",
    },
    "dep__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__lib",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/lib",
    },
    "dep__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__man",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/man",
    },
    "dep__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__doc",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/doc",
    },
    "dep__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__stublibs",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/stublibs",
    },
    "dep__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__toplevel",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/toplevel",
    },
    "dep__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__share",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/share",
    },
    "dep__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__etc",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/etc",
    },
    "app__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "app__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "app__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "app__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__depends",
      "spec": BuildSpec { id: "app" },
      "value": "dep",
    },
    "app__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "app__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app",
    },
    "app__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/bin",
    },
    "app__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/sbin",
    },
    "app__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/lib",
    },
    "app__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/man",
    },
    "app__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/doc",
    },
    "app__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/stublibs",
    },
    "app__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/toplevel",
    },
    "app__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/share",
    },
    "app__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/etc",
    },
    "OCAMLPATH" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLPATH",
      "value": "<storePath>/i/dep/lib",
    },
    "OCAMLFIND_DESTDIR" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_DESTDIR",
      "value": "<storePath>/s/app/lib",
    },
    "OCAMLFIND_LDCONF" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_LDCONF",
      "value": "ignore",
    },
    "OCAMLFIND_COMMANDS" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_COMMANDS",
      "value": "ocamlc=ocamlc.opt ocamldep=ocamldep.opt ocamldoc=ocamldoc.opt ocamllex=ocamllex.opt ocamlopt=ocamlopt.opt",
    },
    "PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "PATH",
      "value": "<storePath>/i/dep/bin:$PATH",
    },
    "MAN_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "MAN_PATH",
      "value": "<storePath>/i/dep/man:$MAN_PATH",
    },
    "cur__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "cur__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "cur__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "cur__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__depends",
      "spec": BuildSpec { id: "app" },
      "value": "dep",
    },
    "cur__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "cur__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app",
    },
    "cur__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/bin",
    },
    "cur__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/sbin",
    },
    "cur__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/lib",
    },
    "cur__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/man",
    },
    "cur__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/doc",
    },
    "cur__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/stublibs",
    },
    "cur__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/toplevel",
    },
    "cur__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/share",
    },
    "cur__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/etc",
    },
    "APP" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "APP",
      "spec": BuildSpec { id: "app" },
      "value": "hello, dep",
    },
  },
}
`;

exports[`calculating env build with (dep with local export) with global export referencing dep local export 1`] = `
Object {
  "env": Map {
    "OCAMLPATH" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLPATH",
      "value": "<storePath>/i/dep/lib",
    },
    "OCAMLFIND_DESTDIR" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_DESTDIR",
      "value": "<storePath>/s/app/lib",
    },
    "OCAMLFIND_LDCONF" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_LDCONF",
      "value": "ignore",
    },
    "OCAMLFIND_COMMANDS" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_COMMANDS",
      "value": "ocamlc=ocamlc.opt ocamldep=ocamldep.opt ocamldoc=ocamldoc.opt ocamllex=ocamllex.opt ocamlopt=ocamlopt.opt",
    },
    "PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "PATH",
      "value": "<storePath>/i/dep/bin:$PATH",
    },
    "MAN_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "MAN_PATH",
      "value": "<storePath>/i/dep/man:$MAN_PATH",
    },
    "cur__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "cur__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "cur__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "cur__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__depends",
      "spec": BuildSpec { id: "app" },
      "value": "dep",
    },
    "cur__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "cur__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app",
    },
    "cur__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/bin",
    },
    "cur__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/sbin",
    },
    "cur__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/lib",
    },
    "cur__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/man",
    },
    "cur__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/doc",
    },
    "cur__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/stublibs",
    },
    "cur__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/toplevel",
    },
    "cur__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/share",
    },
    "cur__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/etc",
    },
    "dep__var" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "dep__var",
      "spec": BuildSpec { id: "dep" },
      "value": "hello",
    },
    "APP" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "APP",
      "spec": BuildSpec { id: "app" },
      "value": "hello, world",
    },
  },
  "scope": Map {
    "dep__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__name",
      "spec": BuildSpec { id: "dep" },
      "value": "dep",
    },
    "dep__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__version",
      "spec": BuildSpec { id: "dep" },
      "value": "0.1.0",
    },
    "dep__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__root",
      "spec": BuildSpec { id: "dep" },
      "value": "<sandboxPath>/dep",
    },
    "dep__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__depends",
      "spec": BuildSpec { id: "dep" },
      "value": "",
    },
    "dep__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__target_dir",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/b/dep",
    },
    "dep__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__install",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep",
    },
    "dep__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__bin",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/bin",
    },
    "dep__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__sbin",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/sbin",
    },
    "dep__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__lib",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/lib",
    },
    "dep__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__man",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/man",
    },
    "dep__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__doc",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/doc",
    },
    "dep__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__stublibs",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/stublibs",
    },
    "dep__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__toplevel",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/toplevel",
    },
    "dep__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__share",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/share",
    },
    "dep__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__etc",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/etc",
    },
    "dep__var" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "dep__var",
      "spec": BuildSpec { id: "dep" },
      "value": "hello",
    },
    "app__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "app__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "app__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "app__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__depends",
      "spec": BuildSpec { id: "app" },
      "value": "dep",
    },
    "app__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "app__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app",
    },
    "app__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/bin",
    },
    "app__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/sbin",
    },
    "app__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/lib",
    },
    "app__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/man",
    },
    "app__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/doc",
    },
    "app__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/stublibs",
    },
    "app__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/toplevel",
    },
    "app__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/share",
    },
    "app__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/etc",
    },
    "OCAMLPATH" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLPATH",
      "value": "<storePath>/i/dep/lib",
    },
    "OCAMLFIND_DESTDIR" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_DESTDIR",
      "value": "<storePath>/s/app/lib",
    },
    "OCAMLFIND_LDCONF" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_LDCONF",
      "value": "ignore",
    },
    "OCAMLFIND_COMMANDS" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_COMMANDS",
      "value": "ocamlc=ocamlc.opt ocamldep=ocamldep.opt ocamldoc=ocamldoc.opt ocamllex=ocamllex.opt ocamlopt=ocamlopt.opt",
    },
    "PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "PATH",
      "value": "<storePath>/i/dep/bin:$PATH",
    },
    "MAN_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "MAN_PATH",
      "value": "<storePath>/i/dep/man:$MAN_PATH",
    },
    "cur__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "cur__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "cur__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "cur__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__depends",
      "spec": BuildSpec { id: "app" },
      "value": "dep",
    },
    "cur__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "cur__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app",
    },
    "cur__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/bin",
    },
    "cur__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/sbin",
    },
    "cur__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/lib",
    },
    "cur__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/man",
    },
    "cur__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/doc",
    },
    "cur__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/stublibs",
    },
    "cur__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/toplevel",
    },
    "cur__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/share",
    },
    "cur__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/etc",
    },
    "APP" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "APP",
      "spec": BuildSpec { id: "app" },
      "value": "hello, world",
    },
  },
}
`;

exports[`calculating env build with (dep with local export) with local export referencing dep built-in 1`] = `
Object {
  "env": Map {
    "OCAMLPATH" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLPATH",
      "value": "<storePath>/i/dep/lib",
    },
    "OCAMLFIND_DESTDIR" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_DESTDIR",
      "value": "<storePath>/s/app/lib",
    },
    "OCAMLFIND_LDCONF" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_LDCONF",
      "value": "ignore",
    },
    "OCAMLFIND_COMMANDS" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_COMMANDS",
      "value": "ocamlc=ocamlc.opt ocamldep=ocamldep.opt ocamldoc=ocamldoc.opt ocamllex=ocamllex.opt ocamlopt=ocamlopt.opt",
    },
    "PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "PATH",
      "value": "<storePath>/i/dep/bin:$PATH",
    },
    "MAN_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "MAN_PATH",
      "value": "<storePath>/i/dep/man:$MAN_PATH",
    },
    "cur__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "cur__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "cur__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "cur__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__depends",
      "spec": BuildSpec { id: "app" },
      "value": "dep",
    },
    "cur__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "cur__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app",
    },
    "cur__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/bin",
    },
    "cur__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/sbin",
    },
    "cur__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/lib",
    },
    "cur__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/man",
    },
    "cur__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/doc",
    },
    "cur__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/stublibs",
    },
    "cur__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/toplevel",
    },
    "cur__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/share",
    },
    "cur__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/etc",
    },
    "app__var" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "app__var",
      "spec": BuildSpec { id: "app" },
      "value": "hello, dep",
    },
  },
  "scope": Map {
    "dep__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__name",
      "spec": BuildSpec { id: "dep" },
      "value": "dep",
    },
    "dep__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__version",
      "spec": BuildSpec { id: "dep" },
      "value": "0.1.0",
    },
    "dep__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__root",
      "spec": BuildSpec { id: "dep" },
      "value": "<sandboxPath>/dep",
    },
    "dep__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__depends",
      "spec": BuildSpec { id: "dep" },
      "value": "",
    },
    "dep__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__target_dir",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/b/dep",
    },
    "dep__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__install",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep",
    },
    "dep__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__bin",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/bin",
    },
    "dep__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__sbin",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/sbin",
    },
    "dep__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__lib",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/lib",
    },
    "dep__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__man",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/man",
    },
    "dep__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__doc",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/doc",
    },
    "dep__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__stublibs",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/stublibs",
    },
    "dep__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__toplevel",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/toplevel",
    },
    "dep__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__share",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/share",
    },
    "dep__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__etc",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/etc",
    },
    "app__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "app__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "app__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "app__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__depends",
      "spec": BuildSpec { id: "app" },
      "value": "dep",
    },
    "app__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "app__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app",
    },
    "app__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/bin",
    },
    "app__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/sbin",
    },
    "app__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/lib",
    },
    "app__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/man",
    },
    "app__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/doc",
    },
    "app__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/stublibs",
    },
    "app__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/toplevel",
    },
    "app__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/share",
    },
    "app__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/etc",
    },
    "OCAMLPATH" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLPATH",
      "value": "<storePath>/i/dep/lib",
    },
    "OCAMLFIND_DESTDIR" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_DESTDIR",
      "value": "<storePath>/s/app/lib",
    },
    "OCAMLFIND_LDCONF" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_LDCONF",
      "value": "ignore",
    },
    "OCAMLFIND_COMMANDS" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_COMMANDS",
      "value": "ocamlc=ocamlc.opt ocamldep=ocamldep.opt ocamldoc=ocamldoc.opt ocamllex=ocamllex.opt ocamlopt=ocamlopt.opt",
    },
    "PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "PATH",
      "value": "<storePath>/i/dep/bin:$PATH",
    },
    "MAN_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "MAN_PATH",
      "value": "<storePath>/i/dep/man:$MAN_PATH",
    },
    "cur__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "cur__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "cur__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "cur__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__depends",
      "spec": BuildSpec { id: "app" },
      "value": "dep",
    },
    "cur__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "cur__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app",
    },
    "cur__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/bin",
    },
    "cur__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/sbin",
    },
    "cur__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/lib",
    },
    "cur__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/man",
    },
    "cur__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/doc",
    },
    "cur__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/stublibs",
    },
    "cur__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/toplevel",
    },
    "cur__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/share",
    },
    "cur__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/etc",
    },
    "app__var" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "app__var",
      "spec": BuildSpec { id: "app" },
      "value": "hello, dep",
    },
  },
}
`;

exports[`calculating env build with (dep with local export) with local export referencing dep local export 1`] = `
Object {
  "env": Map {
    "OCAMLPATH" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLPATH",
      "value": "<storePath>/i/dep/lib",
    },
    "OCAMLFIND_DESTDIR" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_DESTDIR",
      "value": "<storePath>/s/app/lib",
    },
    "OCAMLFIND_LDCONF" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_LDCONF",
      "value": "ignore",
    },
    "OCAMLFIND_COMMANDS" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_COMMANDS",
      "value": "ocamlc=ocamlc.opt ocamldep=ocamldep.opt ocamldoc=ocamldoc.opt ocamllex=ocamllex.opt ocamlopt=ocamlopt.opt",
    },
    "PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "PATH",
      "value": "<storePath>/i/dep/bin:$PATH",
    },
    "MAN_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "MAN_PATH",
      "value": "<storePath>/i/dep/man:$MAN_PATH",
    },
    "cur__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "cur__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "cur__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "cur__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__depends",
      "spec": BuildSpec { id: "app" },
      "value": "dep",
    },
    "cur__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "cur__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app",
    },
    "cur__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/bin",
    },
    "cur__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/sbin",
    },
    "cur__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/lib",
    },
    "cur__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/man",
    },
    "cur__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/doc",
    },
    "cur__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/stublibs",
    },
    "cur__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/toplevel",
    },
    "cur__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/share",
    },
    "cur__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/etc",
    },
    "dep__var" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "dep__var",
      "spec": BuildSpec { id: "dep" },
      "value": "hello",
    },
    "app_var" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "app_var",
      "spec": BuildSpec { id: "app" },
      "value": "hello, world",
    },
  },
  "scope": Map {
    "dep__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__name",
      "spec": BuildSpec { id: "dep" },
      "value": "dep",
    },
    "dep__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__version",
      "spec": BuildSpec { id: "dep" },
      "value": "0.1.0",
    },
    "dep__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__root",
      "spec": BuildSpec { id: "dep" },
      "value": "<sandboxPath>/dep",
    },
    "dep__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__depends",
      "spec": BuildSpec { id: "dep" },
      "value": "",
    },
    "dep__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__target_dir",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/b/dep",
    },
    "dep__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__install",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep",
    },
    "dep__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__bin",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/bin",
    },
    "dep__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__sbin",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/sbin",
    },
    "dep__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__lib",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/lib",
    },
    "dep__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__man",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/man",
    },
    "dep__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__doc",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/doc",
    },
    "dep__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__stublibs",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/stublibs",
    },
    "dep__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__toplevel",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/toplevel",
    },
    "dep__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__share",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/share",
    },
    "dep__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "dep__etc",
      "spec": BuildSpec { id: "dep" },
      "value": "<storePath>/i/dep/etc",
    },
    "dep__var" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "dep__var",
      "spec": BuildSpec { id: "dep" },
      "value": "hello",
    },
    "app__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "app__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "app__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "app__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__depends",
      "spec": BuildSpec { id: "app" },
      "value": "dep",
    },
    "app__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "app__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app",
    },
    "app__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/bin",
    },
    "app__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/sbin",
    },
    "app__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/lib",
    },
    "app__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/man",
    },
    "app__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/doc",
    },
    "app__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/stublibs",
    },
    "app__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/toplevel",
    },
    "app__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/share",
    },
    "app__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/etc",
    },
    "OCAMLPATH" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLPATH",
      "value": "<storePath>/i/dep/lib",
    },
    "OCAMLFIND_DESTDIR" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_DESTDIR",
      "value": "<storePath>/s/app/lib",
    },
    "OCAMLFIND_LDCONF" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_LDCONF",
      "value": "ignore",
    },
    "OCAMLFIND_COMMANDS" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_COMMANDS",
      "value": "ocamlc=ocamlc.opt ocamldep=ocamldep.opt ocamldoc=ocamldoc.opt ocamllex=ocamllex.opt ocamlopt=ocamlopt.opt",
    },
    "PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "PATH",
      "value": "<storePath>/i/dep/bin:$PATH",
    },
    "MAN_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "MAN_PATH",
      "value": "<storePath>/i/dep/man:$MAN_PATH",
    },
    "cur__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "cur__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "cur__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "cur__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__depends",
      "spec": BuildSpec { id: "app" },
      "value": "dep",
    },
    "cur__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "cur__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app",
    },
    "cur__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/bin",
    },
    "cur__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/sbin",
    },
    "cur__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/lib",
    },
    "cur__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/man",
    },
    "cur__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/doc",
    },
    "cur__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/stublibs",
    },
    "cur__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/toplevel",
    },
    "cur__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/share",
    },
    "cur__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/etc",
    },
    "app_var" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "app_var",
      "spec": BuildSpec { id: "app" },
      "value": "hello, world",
    },
  },
}
`;

exports[`calculating env build with global export referencing built-in (cur-version) 1`] = `
Object {
  "env": Map {
    "OCAMLPATH" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLPATH",
      "value": "",
    },
    "OCAMLFIND_DESTDIR" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_DESTDIR",
      "value": "<storePath>/s/app/lib",
    },
    "OCAMLFIND_LDCONF" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_LDCONF",
      "value": "ignore",
    },
    "OCAMLFIND_COMMANDS" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_COMMANDS",
      "value": "ocamlc=ocamlc.opt ocamldep=ocamldep.opt ocamldoc=ocamldoc.opt ocamllex=ocamllex.opt ocamlopt=ocamlopt.opt",
    },
    "PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "PATH",
      "value": "$PATH",
    },
    "MAN_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "MAN_PATH",
      "value": "$MAN_PATH",
    },
    "cur__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "cur__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "cur__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "cur__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__depends",
      "spec": BuildSpec { id: "app" },
      "value": "",
    },
    "cur__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "cur__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app",
    },
    "cur__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/bin",
    },
    "cur__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/sbin",
    },
    "cur__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/lib",
    },
    "cur__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/man",
    },
    "cur__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/doc",
    },
    "cur__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/stublibs",
    },
    "cur__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/toplevel",
    },
    "cur__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/share",
    },
    "cur__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/etc",
    },
    "APP" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "APP",
      "spec": BuildSpec { id: "app" },
      "value": "hello, $cur__name",
    },
  },
  "scope": Map {
    "app__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "app__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "app__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "app__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__depends",
      "spec": BuildSpec { id: "app" },
      "value": "",
    },
    "app__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "app__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app",
    },
    "app__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/bin",
    },
    "app__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/sbin",
    },
    "app__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/lib",
    },
    "app__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/man",
    },
    "app__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/doc",
    },
    "app__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/stublibs",
    },
    "app__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/toplevel",
    },
    "app__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/share",
    },
    "app__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/etc",
    },
    "OCAMLPATH" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLPATH",
      "value": "",
    },
    "OCAMLFIND_DESTDIR" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_DESTDIR",
      "value": "<storePath>/s/app/lib",
    },
    "OCAMLFIND_LDCONF" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_LDCONF",
      "value": "ignore",
    },
    "OCAMLFIND_COMMANDS" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_COMMANDS",
      "value": "ocamlc=ocamlc.opt ocamldep=ocamldep.opt ocamldoc=ocamldoc.opt ocamllex=ocamllex.opt ocamlopt=ocamlopt.opt",
    },
    "PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "PATH",
      "value": "$PATH",
    },
    "MAN_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "MAN_PATH",
      "value": "$MAN_PATH",
    },
    "cur__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "cur__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "cur__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "cur__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__depends",
      "spec": BuildSpec { id: "app" },
      "value": "",
    },
    "cur__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "cur__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app",
    },
    "cur__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/bin",
    },
    "cur__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/sbin",
    },
    "cur__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/lib",
    },
    "cur__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/man",
    },
    "cur__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/doc",
    },
    "cur__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/stublibs",
    },
    "cur__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/toplevel",
    },
    "cur__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/share",
    },
    "cur__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/etc",
    },
    "APP" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "APP",
      "spec": BuildSpec { id: "app" },
      "value": "hello, $cur__name",
    },
  },
}
`;

exports[`calculating env build with global export referencing built-in 1`] = `
Object {
  "env": Map {
    "OCAMLPATH" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLPATH",
      "value": "",
    },
    "OCAMLFIND_DESTDIR" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_DESTDIR",
      "value": "<storePath>/s/app/lib",
    },
    "OCAMLFIND_LDCONF" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_LDCONF",
      "value": "ignore",
    },
    "OCAMLFIND_COMMANDS" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_COMMANDS",
      "value": "ocamlc=ocamlc.opt ocamldep=ocamldep.opt ocamldoc=ocamldoc.opt ocamllex=ocamllex.opt ocamlopt=ocamlopt.opt",
    },
    "PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "PATH",
      "value": "$PATH",
    },
    "MAN_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "MAN_PATH",
      "value": "$MAN_PATH",
    },
    "cur__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "cur__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "cur__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "cur__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__depends",
      "spec": BuildSpec { id: "app" },
      "value": "",
    },
    "cur__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "cur__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app",
    },
    "cur__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/bin",
    },
    "cur__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/sbin",
    },
    "cur__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/lib",
    },
    "cur__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/man",
    },
    "cur__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/doc",
    },
    "cur__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/stublibs",
    },
    "cur__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/toplevel",
    },
    "cur__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/share",
    },
    "cur__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/etc",
    },
    "APP" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "APP",
      "spec": BuildSpec { id: "app" },
      "value": "hello, app",
    },
  },
  "scope": Map {
    "app__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "app__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "app__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "app__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__depends",
      "spec": BuildSpec { id: "app" },
      "value": "",
    },
    "app__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "app__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app",
    },
    "app__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/bin",
    },
    "app__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/sbin",
    },
    "app__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/lib",
    },
    "app__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/man",
    },
    "app__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/doc",
    },
    "app__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/stublibs",
    },
    "app__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/toplevel",
    },
    "app__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/share",
    },
    "app__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/etc",
    },
    "OCAMLPATH" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLPATH",
      "value": "",
    },
    "OCAMLFIND_DESTDIR" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_DESTDIR",
      "value": "<storePath>/s/app/lib",
    },
    "OCAMLFIND_LDCONF" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_LDCONF",
      "value": "ignore",
    },
    "OCAMLFIND_COMMANDS" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_COMMANDS",
      "value": "ocamlc=ocamlc.opt ocamldep=ocamldep.opt ocamldoc=ocamldoc.opt ocamllex=ocamllex.opt ocamlopt=ocamlopt.opt",
    },
    "PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "PATH",
      "value": "$PATH",
    },
    "MAN_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "MAN_PATH",
      "value": "$MAN_PATH",
    },
    "cur__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "cur__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "cur__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "cur__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__depends",
      "spec": BuildSpec { id: "app" },
      "value": "",
    },
    "cur__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "cur__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app",
    },
    "cur__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/bin",
    },
    "cur__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/sbin",
    },
    "cur__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/lib",
    },
    "cur__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/man",
    },
    "cur__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/doc",
    },
    "cur__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/stublibs",
    },
    "cur__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/toplevel",
    },
    "cur__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/share",
    },
    "cur__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/etc",
    },
    "APP" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "APP",
      "spec": BuildSpec { id: "app" },
      "value": "hello, app",
    },
  },
}
`;

exports[`calculating env build with global exports 1`] = `
Object {
  "env": Map {
    "OCAMLPATH" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLPATH",
      "value": "",
    },
    "OCAMLFIND_DESTDIR" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_DESTDIR",
      "value": "<storePath>/s/app/lib",
    },
    "OCAMLFIND_LDCONF" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_LDCONF",
      "value": "ignore",
    },
    "OCAMLFIND_COMMANDS" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_COMMANDS",
      "value": "ocamlc=ocamlc.opt ocamldep=ocamldep.opt ocamldoc=ocamldoc.opt ocamllex=ocamllex.opt ocamlopt=ocamlopt.opt",
    },
    "PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "PATH",
      "value": "$PATH",
    },
    "MAN_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "MAN_PATH",
      "value": "$MAN_PATH",
    },
    "cur__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "cur__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "cur__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "cur__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__depends",
      "spec": BuildSpec { id: "app" },
      "value": "",
    },
    "cur__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "cur__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app",
    },
    "cur__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/bin",
    },
    "cur__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/sbin",
    },
    "cur__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/lib",
    },
    "cur__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/man",
    },
    "cur__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/doc",
    },
    "cur__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/stublibs",
    },
    "cur__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/toplevel",
    },
    "cur__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/share",
    },
    "cur__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/etc",
    },
    "APP" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "APP",
      "spec": BuildSpec { id: "app" },
      "value": "hello",
    },
  },
  "scope": Map {
    "app__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "app__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "app__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "app__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__depends",
      "spec": BuildSpec { id: "app" },
      "value": "",
    },
    "app__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "app__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app",
    },
    "app__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/bin",
    },
    "app__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/sbin",
    },
    "app__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/lib",
    },
    "app__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/man",
    },
    "app__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/doc",
    },
    "app__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/stublibs",
    },
    "app__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/toplevel",
    },
    "app__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/share",
    },
    "app__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/etc",
    },
    "OCAMLPATH" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLPATH",
      "value": "",
    },
    "OCAMLFIND_DESTDIR" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_DESTDIR",
      "value": "<storePath>/s/app/lib",
    },
    "OCAMLFIND_LDCONF" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_LDCONF",
      "value": "ignore",
    },
    "OCAMLFIND_COMMANDS" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_COMMANDS",
      "value": "ocamlc=ocamlc.opt ocamldep=ocamldep.opt ocamldoc=ocamldoc.opt ocamllex=ocamllex.opt ocamlopt=ocamlopt.opt",
    },
    "PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "PATH",
      "value": "$PATH",
    },
    "MAN_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "MAN_PATH",
      "value": "$MAN_PATH",
    },
    "cur__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "cur__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "cur__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "cur__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__depends",
      "spec": BuildSpec { id: "app" },
      "value": "",
    },
    "cur__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "cur__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app",
    },
    "cur__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/bin",
    },
    "cur__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/sbin",
    },
    "cur__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/lib",
    },
    "cur__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/man",
    },
    "cur__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/doc",
    },
    "cur__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/stublibs",
    },
    "cur__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/toplevel",
    },
    "cur__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/share",
    },
    "cur__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/etc",
    },
    "APP" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "APP",
      "spec": BuildSpec { id: "app" },
      "value": "hello",
    },
  },
}
`;

exports[`calculating env build with local exports 1`] = `
Object {
  "env": Map {
    "OCAMLPATH" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLPATH",
      "value": "",
    },
    "OCAMLFIND_DESTDIR" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_DESTDIR",
      "value": "<storePath>/s/app/lib",
    },
    "OCAMLFIND_LDCONF" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_LDCONF",
      "value": "ignore",
    },
    "OCAMLFIND_COMMANDS" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_COMMANDS",
      "value": "ocamlc=ocamlc.opt ocamldep=ocamldep.opt ocamldoc=ocamldoc.opt ocamllex=ocamllex.opt ocamlopt=ocamlopt.opt",
    },
    "PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "PATH",
      "value": "$PATH",
    },
    "MAN_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "MAN_PATH",
      "value": "$MAN_PATH",
    },
    "cur__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "cur__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "cur__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "cur__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__depends",
      "spec": BuildSpec { id: "app" },
      "value": "",
    },
    "cur__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "cur__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app",
    },
    "cur__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/bin",
    },
    "cur__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/sbin",
    },
    "cur__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/lib",
    },
    "cur__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/man",
    },
    "cur__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/doc",
    },
    "cur__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/stublibs",
    },
    "cur__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/toplevel",
    },
    "cur__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/share",
    },
    "cur__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/etc",
    },
    "app__var" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "app__var",
      "spec": BuildSpec { id: "app" },
      "value": "hello",
    },
  },
  "scope": Map {
    "app__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "app__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "app__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "app__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__depends",
      "spec": BuildSpec { id: "app" },
      "value": "",
    },
    "app__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "app__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app",
    },
    "app__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/bin",
    },
    "app__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/sbin",
    },
    "app__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/lib",
    },
    "app__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/man",
    },
    "app__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/doc",
    },
    "app__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/stublibs",
    },
    "app__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/toplevel",
    },
    "app__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/share",
    },
    "app__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/etc",
    },
    "OCAMLPATH" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLPATH",
      "value": "",
    },
    "OCAMLFIND_DESTDIR" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_DESTDIR",
      "value": "<storePath>/s/app/lib",
    },
    "OCAMLFIND_LDCONF" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_LDCONF",
      "value": "ignore",
    },
    "OCAMLFIND_COMMANDS" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_COMMANDS",
      "value": "ocamlc=ocamlc.opt ocamldep=ocamldep.opt ocamldoc=ocamldoc.opt ocamllex=ocamllex.opt ocamlopt=ocamlopt.opt",
    },
    "PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "PATH",
      "value": "$PATH",
    },
    "MAN_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "MAN_PATH",
      "value": "$MAN_PATH",
    },
    "cur__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "cur__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "cur__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "cur__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__depends",
      "spec": BuildSpec { id: "app" },
      "value": "",
    },
    "cur__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "cur__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app",
    },
    "cur__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/bin",
    },
    "cur__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/sbin",
    },
    "cur__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/lib",
    },
    "cur__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/man",
    },
    "cur__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/doc",
    },
    "cur__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/stublibs",
    },
    "cur__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/toplevel",
    },
    "cur__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/share",
    },
    "cur__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/etc",
    },
    "app__var" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "app__var",
      "spec": BuildSpec { id: "app" },
      "value": "hello",
    },
  },
}
`;

exports[`calculating env build with no exports 1`] = `
Object {
  "env": Map {
    "OCAMLPATH" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLPATH",
      "value": "",
    },
    "OCAMLFIND_DESTDIR" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_DESTDIR",
      "value": "<storePath>/s/app/lib",
    },
    "OCAMLFIND_LDCONF" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_LDCONF",
      "value": "ignore",
    },
    "OCAMLFIND_COMMANDS" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_COMMANDS",
      "value": "ocamlc=ocamlc.opt ocamldep=ocamldep.opt ocamldoc=ocamldoc.opt ocamllex=ocamllex.opt ocamlopt=ocamlopt.opt",
    },
    "PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "PATH",
      "value": "$PATH",
    },
    "MAN_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "MAN_PATH",
      "value": "$MAN_PATH",
    },
    "cur__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "cur__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "cur__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "cur__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__depends",
      "spec": BuildSpec { id: "app" },
      "value": "",
    },
    "cur__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "cur__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app",
    },
    "cur__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/bin",
    },
    "cur__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/sbin",
    },
    "cur__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/lib",
    },
    "cur__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/man",
    },
    "cur__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/doc",
    },
    "cur__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/stublibs",
    },
    "cur__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/toplevel",
    },
    "cur__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/share",
    },
    "cur__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/etc",
    },
  },
  "scope": Map {
    "app__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "app__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "app__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "app__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__depends",
      "spec": BuildSpec { id: "app" },
      "value": "",
    },
    "app__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "app__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app",
    },
    "app__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/bin",
    },
    "app__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/sbin",
    },
    "app__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/lib",
    },
    "app__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/man",
    },
    "app__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/doc",
    },
    "app__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/stublibs",
    },
    "app__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/toplevel",
    },
    "app__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/share",
    },
    "app__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/etc",
    },
    "OCAMLPATH" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLPATH",
      "value": "",
    },
    "OCAMLFIND_DESTDIR" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_DESTDIR",
      "value": "<storePath>/s/app/lib",
    },
    "OCAMLFIND_LDCONF" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_LDCONF",
      "value": "ignore",
    },
    "OCAMLFIND_COMMANDS" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_COMMANDS",
      "value": "ocamlc=ocamlc.opt ocamldep=ocamldep.opt ocamldoc=ocamldoc.opt ocamllex=ocamllex.opt ocamlopt=ocamlopt.opt",
    },
    "PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "PATH",
      "value": "$PATH",
    },
    "MAN_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "MAN_PATH",
      "value": "$MAN_PATH",
    },
    "cur__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "cur__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "cur__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "cur__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__depends",
      "spec": BuildSpec { id: "app" },
      "value": "",
    },
    "cur__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "cur__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app",
    },
    "cur__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/bin",
    },
    "cur__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/sbin",
    },
    "cur__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/lib",
    },
    "cur__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/man",
    },
    "cur__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/doc",
    },
    "cur__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/stublibs",
    },
    "cur__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/toplevel",
    },
    "cur__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/share",
    },
    "cur__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/etc",
    },
  },
}
`;

exports[`calculating env concatenating global exports (same level exports + package itself) 1`] = `
Object {
  "env": Map {
    "OCAMLPATH" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLPATH",
      "value": "<storePath>/i/ocaml/lib:<storePath>/i/ocamlfind/lib:<storePath>/i/lwt/lib",
    },
    "OCAMLFIND_DESTDIR" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_DESTDIR",
      "value": "<storePath>/s/app/lib",
    },
    "OCAMLFIND_LDCONF" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_LDCONF",
      "value": "ignore",
    },
    "OCAMLFIND_COMMANDS" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_COMMANDS",
      "value": "ocamlc=ocamlc.opt ocamldep=ocamldep.opt ocamldoc=ocamldoc.opt ocamllex=ocamllex.opt ocamlopt=ocamlopt.opt",
    },
    "PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "PATH",
      "value": "<storePath>/i/ocaml/bin:<storePath>/i/ocamlfind/bin:<storePath>/i/lwt/bin:$PATH",
    },
    "MAN_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "MAN_PATH",
      "value": "<storePath>/i/ocaml/man:<storePath>/i/ocamlfind/man:<storePath>/i/lwt/man:$MAN_PATH",
    },
    "cur__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "cur__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "cur__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "cur__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__depends",
      "spec": BuildSpec { id: "app" },
      "value": "ocamlfind lwt",
    },
    "cur__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "cur__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app",
    },
    "cur__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/bin",
    },
    "cur__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/sbin",
    },
    "cur__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/lib",
    },
    "cur__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/man",
    },
    "cur__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/doc",
    },
    "cur__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/stublibs",
    },
    "cur__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/toplevel",
    },
    "cur__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/share",
    },
    "cur__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/etc",
    },
    "CAML_LD_LIBRARY_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "CAML_LD_LIBRARY_PATH",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/lib:<storePath>/i/lwt/lib/ocaml:<storePath>/i/ocamlfind/lib/ocaml:<storePath>/i/ocaml/lib/ocaml",
    },
  },
  "scope": Map {
    "ocamlfind__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__name",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "ocamlfind",
    },
    "ocamlfind__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__version",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "0.1.0",
    },
    "ocamlfind__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__root",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<sandboxPath>/ocamlfind",
    },
    "ocamlfind__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__depends",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "ocaml",
    },
    "ocamlfind__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__target_dir",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/b/ocamlfind",
    },
    "ocamlfind__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__install",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind",
    },
    "ocamlfind__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__bin",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind/bin",
    },
    "ocamlfind__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__sbin",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind/sbin",
    },
    "ocamlfind__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__lib",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind/lib",
    },
    "ocamlfind__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__man",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind/man",
    },
    "ocamlfind__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__doc",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind/doc",
    },
    "ocamlfind__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__stublibs",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind/stublibs",
    },
    "ocamlfind__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__toplevel",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind/toplevel",
    },
    "ocamlfind__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__share",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind/share",
    },
    "ocamlfind__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__etc",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind/etc",
    },
    "lwt__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "lwt__name",
      "spec": BuildSpec { id: "lwt" },
      "value": "lwt",
    },
    "lwt__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "lwt__version",
      "spec": BuildSpec { id: "lwt" },
      "value": "0.1.0",
    },
    "lwt__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "lwt__root",
      "spec": BuildSpec { id: "lwt" },
      "value": "<sandboxPath>/lwt",
    },
    "lwt__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "lwt__depends",
      "spec": BuildSpec { id: "lwt" },
      "value": "ocaml",
    },
    "lwt__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "lwt__target_dir",
      "spec": BuildSpec { id: "lwt" },
      "value": "<storePath>/b/lwt",
    },
    "lwt__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "lwt__install",
      "spec": BuildSpec { id: "lwt" },
      "value": "<storePath>/i/lwt",
    },
    "lwt__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "lwt__bin",
      "spec": BuildSpec { id: "lwt" },
      "value": "<storePath>/i/lwt/bin",
    },
    "lwt__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "lwt__sbin",
      "spec": BuildSpec { id: "lwt" },
      "value": "<storePath>/i/lwt/sbin",
    },
    "lwt__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "lwt__lib",
      "spec": BuildSpec { id: "lwt" },
      "value": "<storePath>/i/lwt/lib",
    },
    "lwt__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "lwt__man",
      "spec": BuildSpec { id: "lwt" },
      "value": "<storePath>/i/lwt/man",
    },
    "lwt__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "lwt__doc",
      "spec": BuildSpec { id: "lwt" },
      "value": "<storePath>/i/lwt/doc",
    },
    "lwt__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "lwt__stublibs",
      "spec": BuildSpec { id: "lwt" },
      "value": "<storePath>/i/lwt/stublibs",
    },
    "lwt__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "lwt__toplevel",
      "spec": BuildSpec { id: "lwt" },
      "value": "<storePath>/i/lwt/toplevel",
    },
    "lwt__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "lwt__share",
      "spec": BuildSpec { id: "lwt" },
      "value": "<storePath>/i/lwt/share",
    },
    "lwt__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "lwt__etc",
      "spec": BuildSpec { id: "lwt" },
      "value": "<storePath>/i/lwt/etc",
    },
    "app__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "app__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "app__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "app__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__depends",
      "spec": BuildSpec { id: "app" },
      "value": "ocamlfind lwt",
    },
    "app__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "app__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app",
    },
    "app__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/bin",
    },
    "app__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/sbin",
    },
    "app__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/lib",
    },
    "app__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/man",
    },
    "app__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/doc",
    },
    "app__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/stublibs",
    },
    "app__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/toplevel",
    },
    "app__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/share",
    },
    "app__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/etc",
    },
    "OCAMLPATH" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLPATH",
      "value": "<storePath>/i/ocaml/lib:<storePath>/i/ocamlfind/lib:<storePath>/i/lwt/lib",
    },
    "OCAMLFIND_DESTDIR" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_DESTDIR",
      "value": "<storePath>/s/app/lib",
    },
    "OCAMLFIND_LDCONF" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_LDCONF",
      "value": "ignore",
    },
    "OCAMLFIND_COMMANDS" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_COMMANDS",
      "value": "ocamlc=ocamlc.opt ocamldep=ocamldep.opt ocamldoc=ocamldoc.opt ocamllex=ocamllex.opt ocamlopt=ocamlopt.opt",
    },
    "PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "PATH",
      "value": "<storePath>/i/ocaml/bin:<storePath>/i/ocamlfind/bin:<storePath>/i/lwt/bin:$PATH",
    },
    "MAN_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "MAN_PATH",
      "value": "<storePath>/i/ocaml/man:<storePath>/i/ocamlfind/man:<storePath>/i/lwt/man:$MAN_PATH",
    },
    "cur__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "cur__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "cur__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "cur__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__depends",
      "spec": BuildSpec { id: "app" },
      "value": "ocamlfind lwt",
    },
    "cur__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "cur__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app",
    },
    "cur__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/bin",
    },
    "cur__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/sbin",
    },
    "cur__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/lib",
    },
    "cur__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/man",
    },
    "cur__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/doc",
    },
    "cur__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/stublibs",
    },
    "cur__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/toplevel",
    },
    "cur__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/share",
    },
    "cur__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/etc",
    },
    "CAML_LD_LIBRARY_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "CAML_LD_LIBRARY_PATH",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/lib:<storePath>/i/lwt/lib/ocaml:<storePath>/i/ocamlfind/lib/ocaml:<storePath>/i/ocaml/lib/ocaml",
    },
  },
}
`;

exports[`calculating env concatenating global exports (same level exports) 1`] = `
Object {
  "env": Map {
    "OCAMLPATH" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLPATH",
      "value": "<storePath>/i/ocaml/lib:<storePath>/i/ocamlfind/lib:<storePath>/i/lwt/lib",
    },
    "OCAMLFIND_DESTDIR" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_DESTDIR",
      "value": "<storePath>/s/app/lib",
    },
    "OCAMLFIND_LDCONF" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_LDCONF",
      "value": "ignore",
    },
    "OCAMLFIND_COMMANDS" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_COMMANDS",
      "value": "ocamlc=ocamlc.opt ocamldep=ocamldep.opt ocamldoc=ocamldoc.opt ocamllex=ocamllex.opt ocamlopt=ocamlopt.opt",
    },
    "PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "PATH",
      "value": "<storePath>/i/ocaml/bin:<storePath>/i/ocamlfind/bin:<storePath>/i/lwt/bin:$PATH",
    },
    "MAN_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "MAN_PATH",
      "value": "<storePath>/i/ocaml/man:<storePath>/i/ocamlfind/man:<storePath>/i/lwt/man:$MAN_PATH",
    },
    "cur__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "cur__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "cur__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "cur__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__depends",
      "spec": BuildSpec { id: "app" },
      "value": "ocamlfind lwt",
    },
    "cur__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "cur__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app",
    },
    "cur__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/bin",
    },
    "cur__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/sbin",
    },
    "cur__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/lib",
    },
    "cur__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/man",
    },
    "cur__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/doc",
    },
    "cur__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/stublibs",
    },
    "cur__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/toplevel",
    },
    "cur__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/share",
    },
    "cur__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/etc",
    },
    "CAML_LD_LIBRARY_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "CAML_LD_LIBRARY_PATH",
      "spec": BuildSpec { id: "lwt" },
      "value": "<storePath>/i/lwt/lib/ocaml:<storePath>/i/ocamlfind/lib/ocaml:<storePath>/i/ocaml/lib/ocaml",
    },
  },
  "scope": Map {
    "ocamlfind__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__name",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "ocamlfind",
    },
    "ocamlfind__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__version",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "0.1.0",
    },
    "ocamlfind__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__root",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<sandboxPath>/ocamlfind",
    },
    "ocamlfind__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__depends",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "ocaml",
    },
    "ocamlfind__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__target_dir",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/b/ocamlfind",
    },
    "ocamlfind__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__install",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind",
    },
    "ocamlfind__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__bin",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind/bin",
    },
    "ocamlfind__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__sbin",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind/sbin",
    },
    "ocamlfind__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__lib",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind/lib",
    },
    "ocamlfind__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__man",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind/man",
    },
    "ocamlfind__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__doc",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind/doc",
    },
    "ocamlfind__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__stublibs",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind/stublibs",
    },
    "ocamlfind__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__toplevel",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind/toplevel",
    },
    "ocamlfind__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__share",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind/share",
    },
    "ocamlfind__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__etc",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind/etc",
    },
    "lwt__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "lwt__name",
      "spec": BuildSpec { id: "lwt" },
      "value": "lwt",
    },
    "lwt__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "lwt__version",
      "spec": BuildSpec { id: "lwt" },
      "value": "0.1.0",
    },
    "lwt__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "lwt__root",
      "spec": BuildSpec { id: "lwt" },
      "value": "<sandboxPath>/lwt",
    },
    "lwt__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "lwt__depends",
      "spec": BuildSpec { id: "lwt" },
      "value": "ocaml",
    },
    "lwt__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "lwt__target_dir",
      "spec": BuildSpec { id: "lwt" },
      "value": "<storePath>/b/lwt",
    },
    "lwt__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "lwt__install",
      "spec": BuildSpec { id: "lwt" },
      "value": "<storePath>/i/lwt",
    },
    "lwt__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "lwt__bin",
      "spec": BuildSpec { id: "lwt" },
      "value": "<storePath>/i/lwt/bin",
    },
    "lwt__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "lwt__sbin",
      "spec": BuildSpec { id: "lwt" },
      "value": "<storePath>/i/lwt/sbin",
    },
    "lwt__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "lwt__lib",
      "spec": BuildSpec { id: "lwt" },
      "value": "<storePath>/i/lwt/lib",
    },
    "lwt__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "lwt__man",
      "spec": BuildSpec { id: "lwt" },
      "value": "<storePath>/i/lwt/man",
    },
    "lwt__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "lwt__doc",
      "spec": BuildSpec { id: "lwt" },
      "value": "<storePath>/i/lwt/doc",
    },
    "lwt__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "lwt__stublibs",
      "spec": BuildSpec { id: "lwt" },
      "value": "<storePath>/i/lwt/stublibs",
    },
    "lwt__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "lwt__toplevel",
      "spec": BuildSpec { id: "lwt" },
      "value": "<storePath>/i/lwt/toplevel",
    },
    "lwt__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "lwt__share",
      "spec": BuildSpec { id: "lwt" },
      "value": "<storePath>/i/lwt/share",
    },
    "lwt__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "lwt__etc",
      "spec": BuildSpec { id: "lwt" },
      "value": "<storePath>/i/lwt/etc",
    },
    "app__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "app__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "app__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "app__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__depends",
      "spec": BuildSpec { id: "app" },
      "value": "ocamlfind lwt",
    },
    "app__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "app__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app",
    },
    "app__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/bin",
    },
    "app__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/sbin",
    },
    "app__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/lib",
    },
    "app__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/man",
    },
    "app__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/doc",
    },
    "app__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/stublibs",
    },
    "app__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/toplevel",
    },
    "app__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/share",
    },
    "app__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/etc",
    },
    "OCAMLPATH" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLPATH",
      "value": "<storePath>/i/ocaml/lib:<storePath>/i/ocamlfind/lib:<storePath>/i/lwt/lib",
    },
    "OCAMLFIND_DESTDIR" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_DESTDIR",
      "value": "<storePath>/s/app/lib",
    },
    "OCAMLFIND_LDCONF" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_LDCONF",
      "value": "ignore",
    },
    "OCAMLFIND_COMMANDS" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_COMMANDS",
      "value": "ocamlc=ocamlc.opt ocamldep=ocamldep.opt ocamldoc=ocamldoc.opt ocamllex=ocamllex.opt ocamlopt=ocamlopt.opt",
    },
    "PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "PATH",
      "value": "<storePath>/i/ocaml/bin:<storePath>/i/ocamlfind/bin:<storePath>/i/lwt/bin:$PATH",
    },
    "MAN_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "MAN_PATH",
      "value": "<storePath>/i/ocaml/man:<storePath>/i/ocamlfind/man:<storePath>/i/lwt/man:$MAN_PATH",
    },
    "cur__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "cur__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "cur__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "cur__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__depends",
      "spec": BuildSpec { id: "app" },
      "value": "ocamlfind lwt",
    },
    "cur__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "cur__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app",
    },
    "cur__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/bin",
    },
    "cur__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/sbin",
    },
    "cur__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/lib",
    },
    "cur__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/man",
    },
    "cur__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/doc",
    },
    "cur__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/stublibs",
    },
    "cur__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/toplevel",
    },
    "cur__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/share",
    },
    "cur__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/etc",
    },
    "CAML_LD_LIBRARY_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "CAML_LD_LIBRARY_PATH",
      "spec": BuildSpec { id: "lwt" },
      "value": "<storePath>/i/lwt/lib/ocaml:<storePath>/i/ocamlfind/lib/ocaml:<storePath>/i/ocaml/lib/ocaml",
    },
  },
}
`;

exports[`calculating env concatenating global exports 1`] = `
Object {
  "env": Map {
    "OCAMLPATH" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLPATH",
      "value": "<storePath>/i/ocaml/lib:<storePath>/i/ocamlfind/lib",
    },
    "OCAMLFIND_DESTDIR" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_DESTDIR",
      "value": "<storePath>/s/app/lib",
    },
    "OCAMLFIND_LDCONF" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_LDCONF",
      "value": "ignore",
    },
    "OCAMLFIND_COMMANDS" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_COMMANDS",
      "value": "ocamlc=ocamlc.opt ocamldep=ocamldep.opt ocamldoc=ocamldoc.opt ocamllex=ocamllex.opt ocamlopt=ocamlopt.opt",
    },
    "PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "PATH",
      "value": "<storePath>/i/ocaml/bin:<storePath>/i/ocamlfind/bin:$PATH",
    },
    "MAN_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "MAN_PATH",
      "value": "<storePath>/i/ocaml/man:<storePath>/i/ocamlfind/man:$MAN_PATH",
    },
    "cur__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "cur__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "cur__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "cur__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__depends",
      "spec": BuildSpec { id: "app" },
      "value": "ocamlfind ocaml",
    },
    "cur__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "cur__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app",
    },
    "cur__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/bin",
    },
    "cur__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/sbin",
    },
    "cur__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/lib",
    },
    "cur__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/man",
    },
    "cur__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/doc",
    },
    "cur__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/stublibs",
    },
    "cur__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/toplevel",
    },
    "cur__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/share",
    },
    "cur__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/etc",
    },
    "CAML_LD_LIBRARY_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "CAML_LD_LIBRARY_PATH",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind/lib/ocaml:<storePath>/i/ocaml/lib/ocaml",
    },
  },
  "scope": Map {
    "ocaml__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocaml__name",
      "spec": BuildSpec { id: "ocaml" },
      "value": "ocaml",
    },
    "ocaml__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocaml__version",
      "spec": BuildSpec { id: "ocaml" },
      "value": "0.1.0",
    },
    "ocaml__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocaml__root",
      "spec": BuildSpec { id: "ocaml" },
      "value": "<sandboxPath>/ocaml",
    },
    "ocaml__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocaml__depends",
      "spec": BuildSpec { id: "ocaml" },
      "value": "",
    },
    "ocaml__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocaml__target_dir",
      "spec": BuildSpec { id: "ocaml" },
      "value": "<storePath>/b/ocaml",
    },
    "ocaml__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocaml__install",
      "spec": BuildSpec { id: "ocaml" },
      "value": "<storePath>/i/ocaml",
    },
    "ocaml__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocaml__bin",
      "spec": BuildSpec { id: "ocaml" },
      "value": "<storePath>/i/ocaml/bin",
    },
    "ocaml__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocaml__sbin",
      "spec": BuildSpec { id: "ocaml" },
      "value": "<storePath>/i/ocaml/sbin",
    },
    "ocaml__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocaml__lib",
      "spec": BuildSpec { id: "ocaml" },
      "value": "<storePath>/i/ocaml/lib",
    },
    "ocaml__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocaml__man",
      "spec": BuildSpec { id: "ocaml" },
      "value": "<storePath>/i/ocaml/man",
    },
    "ocaml__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocaml__doc",
      "spec": BuildSpec { id: "ocaml" },
      "value": "<storePath>/i/ocaml/doc",
    },
    "ocaml__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocaml__stublibs",
      "spec": BuildSpec { id: "ocaml" },
      "value": "<storePath>/i/ocaml/stublibs",
    },
    "ocaml__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocaml__toplevel",
      "spec": BuildSpec { id: "ocaml" },
      "value": "<storePath>/i/ocaml/toplevel",
    },
    "ocaml__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocaml__share",
      "spec": BuildSpec { id: "ocaml" },
      "value": "<storePath>/i/ocaml/share",
    },
    "ocaml__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocaml__etc",
      "spec": BuildSpec { id: "ocaml" },
      "value": "<storePath>/i/ocaml/etc",
    },
    "ocamlfind__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__name",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "ocamlfind",
    },
    "ocamlfind__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__version",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "0.1.0",
    },
    "ocamlfind__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__root",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<sandboxPath>/ocamlfind",
    },
    "ocamlfind__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__depends",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "ocaml",
    },
    "ocamlfind__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__target_dir",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/b/ocamlfind",
    },
    "ocamlfind__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__install",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind",
    },
    "ocamlfind__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__bin",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind/bin",
    },
    "ocamlfind__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__sbin",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind/sbin",
    },
    "ocamlfind__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__lib",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind/lib",
    },
    "ocamlfind__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__man",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind/man",
    },
    "ocamlfind__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__doc",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind/doc",
    },
    "ocamlfind__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__stublibs",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind/stublibs",
    },
    "ocamlfind__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__toplevel",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind/toplevel",
    },
    "ocamlfind__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__share",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind/share",
    },
    "ocamlfind__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "ocamlfind__etc",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind/etc",
    },
    "app__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "app__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "app__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "app__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__depends",
      "spec": BuildSpec { id: "app" },
      "value": "ocamlfind ocaml",
    },
    "app__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "app__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app",
    },
    "app__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/bin",
    },
    "app__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/sbin",
    },
    "app__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/lib",
    },
    "app__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/man",
    },
    "app__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/doc",
    },
    "app__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/stublibs",
    },
    "app__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/toplevel",
    },
    "app__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/share",
    },
    "app__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "app__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/i/app/etc",
    },
    "OCAMLPATH" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLPATH",
      "value": "<storePath>/i/ocaml/lib:<storePath>/i/ocamlfind/lib",
    },
    "OCAMLFIND_DESTDIR" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_DESTDIR",
      "value": "<storePath>/s/app/lib",
    },
    "OCAMLFIND_LDCONF" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_LDCONF",
      "value": "ignore",
    },
    "OCAMLFIND_COMMANDS" => Object {
      "builtIn": false,
      "exclusive": true,
      "exported": true,
      "name": "OCAMLFIND_COMMANDS",
      "value": "ocamlc=ocamlc.opt ocamldep=ocamldep.opt ocamldoc=ocamldoc.opt ocamllex=ocamllex.opt ocamlopt=ocamlopt.opt",
    },
    "PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "PATH",
      "value": "<storePath>/i/ocaml/bin:<storePath>/i/ocamlfind/bin:$PATH",
    },
    "MAN_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "MAN_PATH",
      "value": "<storePath>/i/ocaml/man:<storePath>/i/ocamlfind/man:$MAN_PATH",
    },
    "cur__name" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__name",
      "spec": BuildSpec { id: "app" },
      "value": "app",
    },
    "cur__version" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__version",
      "spec": BuildSpec { id: "app" },
      "value": "0.1.0",
    },
    "cur__root" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__root",
      "spec": BuildSpec { id: "app" },
      "value": "<sandboxPath>/app",
    },
    "cur__depends" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__depends",
      "spec": BuildSpec { id: "app" },
      "value": "ocamlfind ocaml",
    },
    "cur__target_dir" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__target_dir",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/b/app",
    },
    "cur__install" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__install",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app",
    },
    "cur__bin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__bin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/bin",
    },
    "cur__sbin" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__sbin",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/sbin",
    },
    "cur__lib" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__lib",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/lib",
    },
    "cur__man" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__man",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/man",
    },
    "cur__doc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__doc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/doc",
    },
    "cur__stublibs" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__stublibs",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/stublibs",
    },
    "cur__toplevel" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__toplevel",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/toplevel",
    },
    "cur__share" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__share",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/share",
    },
    "cur__etc" => Object {
      "builtIn": true,
      "exclusive": true,
      "exported": false,
      "name": "cur__etc",
      "spec": BuildSpec { id: "app" },
      "value": "<storePath>/s/app/etc",
    },
    "CAML_LD_LIBRARY_PATH" => Object {
      "builtIn": false,
      "exclusive": false,
      "exported": true,
      "name": "CAML_LD_LIBRARY_PATH",
      "spec": BuildSpec { id: "ocamlfind" },
      "value": "<storePath>/i/ocamlfind/lib/ocaml:<storePath>/i/ocaml/lib/ocaml",
    },
  },
}
`;

exports[`calculating env exposing own $cur__bin in $PATH 1`] = `
Object {
  "builtIn": false,
  "exclusive": false,
  "exported": true,
  "name": "PATH",
  "value": "<storePath>/i/dep/bin:$PATH",
}
`;

exports[`calculating env exposing own $cur__bin in $PATH 2`] = `
Object {
  "builtIn": false,
  "exclusive": true,
  "exported": true,
  "name": "OCAMLPATH",
  "value": "<storePath>/i/dep/lib",
}
`;
